# Simple, yet accurate one-dimensional climate model

Using the rapid radiative transfer model, this program simulates a one-dimensional atmosphere. The model incorporates several effects and achieves accurate predictions for the temperature increase for, e.g., a doubling in CO2.

## Brief repository overview

* `model.c`: Actual model to simulate the climate of the earth

* `thermal_radiation.c`: Main library for computing the transport of radiation

* `opacity_analysis.c`: Table producing program for visualizing an atmosphere with a window

* `ascii/`: Code for reading in atmospheric tables and an atmospheric table containing H2O and O3 concentrations by atmospheric layer

* `eddington/`: Code for computing transmissivity, reflectivity and scattering properties

* `gnuplot_i/`: Plotting utilities

* `rrtm/`: Folder in which it is assumed the RRTM libraries are placed in

## Simple thermal-only RRTM without water vapor feedback, cloud-fraction and so forth

Normal CO2 concentration (`400 ppm`)

```txt
Iteration   10100 at time 553.07d (47785091.6s)
      Edn[W]       Eup[W]     T_lyr[K]
      0.0000     219.1965     164.8405
      2.7151     221.9087     175.1103
      5.5124     224.7036     178.6134
      8.0685     227.2579     181.0704
     11.7649     230.9532     189.0177
     18.3558     236.1255     200.1639
     28.8592     242.0552     209.9114
     41.7689     249.0828     218.6213
     55.6551     257.0340     226.5299
     70.3306     265.7761     233.7932
     85.9823     275.2818     240.5219
    102.6176     285.4598     246.7994
    120.3217     296.2707     252.6894
    139.0327     307.6804     258.2433
    158.3875     319.5979     263.5048
    178.1668     331.9569     268.5088
    198.1971     344.6605     273.2840
    218.1818     357.4433     277.8539
    238.2081     369.9955     282.2349
    258.4409     381.6937     286.4367
    278.9967     381.6937          nan
```

Double CO2 concentration (`800 ppm`)

```txt
Iteration    9900 at time 541.05d (46746732.3s)
      Edn[W]       Eup[W]     T_lyr[K]
      0.0000     219.0119     163.2206
      2.8596     221.8686     174.3734
      5.8204     224.8270     178.6387
      8.5450     227.5498     181.7767
     12.4748     231.4786     189.9289
     19.4193     236.9950     201.1289
     30.4278     243.3078     210.9225
     43.8979     250.7431     219.6733
     58.3505     259.1434     227.6191
     73.6082     268.3723     234.9169
     89.8671     278.3740     241.6772
    107.0883     289.0498     247.9844
    125.3425     300.3583     253.9026
    144.5476     312.2633     259.4836
    164.3155     324.6641     264.7714
    184.4677     337.5066     269.8009
    204.8292     350.6906     274.6008
    225.1163     363.9447     279.1947
    245.4556     376.9652     283.5987
    266.0286     389.1324     287.8224
    286.9331     389.1324          nan
```

## "Full" RRTM with water vapor feedback

Normal CO2

```txt
Iteration    3850 at time 739.40d (63884265.2s)
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     336.9287       0.0000     240.4120     340.5000       0.0000      96.5167      32231.7     230.1434
    337.8960     334.3247      15.1263     239.2264     319.7512       3.0185      95.0983      22874.3     222.1913
    336.0919     332.5205      18.9995     239.1537     311.3027       5.7897      93.3668      18523.4     217.4392
    334.3262     330.7547      20.9260     239.2373     304.9979       8.4022      91.5173      15657.5     213.5027
    332.7618     329.1901      22.4700     239.4988     299.4399      10.8519      89.6913      13516.9     210.2654
    331.7122     328.1404      24.2976     240.2225     294.2663      13.1482      87.9179      11807.7     208.4203
    331.4834     327.9114      26.8534     241.7144     289.3251      15.3049      86.1971      10384.8     209.1672
    331.8101     328.2380      29.8496     243.7054     284.6292      17.3313      84.5325       9166.0     211.3402
    333.1037     329.5314      33.8839     246.6055     279.9833      19.2365      82.9258       8099.9     215.9401
    325.2588     321.6863      41.6076     251.2637     244.5071      39.1441      70.4226       7152.6     217.4941
    327.0112     323.4384      45.9057     254.4126     240.5541      40.5514      69.0257       6300.1     220.7548
    329.7344     326.1613      51.2353     258.4868     236.6320      41.8670      67.6745       5525.2     225.1650
    333.9047     330.3314      58.1978     263.9589     232.6154      43.0915      66.3725       4815.0     231.1229
    340.6525     336.6131      68.1686     271.4797     228.2656      44.2183      65.1334       4159.5     238.9065
    351.6166     344.2051      83.2240     280.2023     223.1660      45.2266      64.0028       3550.9     246.3337
    334.4479     322.0805     120.4908     304.9504     128.4887      85.4684      17.1302       2982.8     253.4809
    345.1270     334.3183     147.0502     329.5023     120.1649      77.9120       4.8160       2450.3     260.3203
    362.3820     346.8381     168.2794     342.8876     116.4623      77.6402       3.9506       1949.2     266.8947
    381.9743     360.6861     192.0337     357.5758     112.7056      77.2351       3.1103       1475.8     273.2288
    403.4076     375.6693     217.7051     373.3759     108.9714      76.7311       2.2934       1027.4     279.3472
    426.3628     391.4731     244.9444     389.9727     105.2688      76.1496       1.5004        601.5     285.2657
    450.7484     407.2165     273.6783     406.4826     101.5689      75.5012       0.7339        195.8     290.9792
    476.7981     406.4826     304.1033     406.4826      97.9008      74.7940       0.0000          nan          nan
```

Normal CO2 (100 layers)

```txt
Iteration   23130 at time 725.06d (62645132.5s)
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     335.9236       0.0000     239.0332     340.5000       0.0000      96.8903      45131.0     245.4121
    338.4920     333.9155       7.4702     237.3130     330.3108       0.7109      96.6025      35773.0     231.5140
    337.6278     333.0514       9.6874     236.7362     326.5615       1.3790      96.3152      31421.8     227.0461
    337.0622     332.4857      11.5227     236.4755     323.5105       2.0289      96.0103      28555.8     224.6486
    336.6037     332.0272      13.0369     236.3442     320.9001       2.6667      95.6830      26415.1     222.8870
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    441.9606     394.6239     263.2549     393.8115     102.8213      75.8844       0.8124        392.2     286.0701
    447.4011     397.9020     269.6397     397.2555     102.0225      75.7390       0.6465        303.5     287.3194
    452.9102     401.0850     276.0950     400.6028     101.2243      75.5908       0.4822        215.7     288.5582
    458.4893     404.0940     282.6216     403.7744     100.4276      75.4401       0.3196        128.7     289.7850
    464.1415     406.7392     289.2214     406.5804      99.6332      75.2869       0.1588         42.7     290.9967
    469.8616     406.5804     295.8884     406.5804      98.8419      75.1313       0.0000          nan          nan
```

Double CO2

```txt
Iteration    3965 at time 743.84d (64267942.3s)
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     336.6321       0.0000     240.4145     340.5000       0.0000      96.2177      32490.7     227.0460
    338.4249     334.5569      15.8382     239.7597     319.5671       3.0195      94.7972      23058.1     221.3670
    336.7070     332.8390      19.9478     239.7737     310.9679       5.7912      93.0653      18672.2     217.1949
    334.8900     331.0218      21.8842     239.8062     304.6015       8.4042      91.2156      15783.3     213.3393
    333.3001     329.4318      23.4239     240.0424     299.0220      10.8542      89.3894      13625.5     210.1768
    332.2986     328.4302      25.3060     240.8143     293.8419      13.1507      87.6159      11902.6     208.5106
    332.2002     328.3316      28.0200     242.4365     288.8726      15.3076      85.8951      10468.3     209.4418
    332.7065     328.8378      31.2575     244.6069     284.1150      17.3340      84.2309       9239.6     211.7878
    334.2573     330.3883      35.6340     247.7632     279.3842      19.2390      82.6252       8165.0     216.4434
    326.7699     322.9008      43.7660     252.7646     243.8962      39.1077      70.1361       7210.0     218.2992
    328.8730     325.0037      48.5041     256.2637     239.8566      40.5124      68.7400       6350.7     221.8088
    332.0986     328.2289      54.4253     260.8390     235.8486      41.8247      67.3899       5569.6     226.5475
    337.0286     333.1587      62.2614     267.0685     231.7227      43.0445      66.0902       4853.7     232.9737
    345.0293     340.2417      73.6715     275.3849     227.1949      44.1630      64.8569       4193.0     240.8094
    357.2515     348.6942      90.1868     284.9573     221.9048      45.1598      63.7369       3579.4     248.2823
    341.7917     327.8030     128.9659     310.7376     127.6443      85.1815      17.0654       3006.8     255.4926
    353.9023     341.2269     156.9935     336.4285     119.2747      77.6342       4.7984       2470.0     262.3716
    372.4385     354.9147     179.5967     350.9796     115.5039      77.3379       3.9351       1964.8     268.9982
    393.2262     369.9875     204.6288     366.8903     111.6889      76.9085       3.0971       1487.7     275.3866
    415.6420     386.2499     231.3576     383.9671     107.9036      76.3807       2.2828       1035.7     281.5643
    439.4486     403.3684     259.5326     401.8757     104.1407      75.7752       1.4927        606.3     287.5450
    464.8245     420.4322     289.3448     419.7026     100.3790      75.1007       0.7296        197.4     293.3173
    492.2192     419.7026     321.1851     419.7026      96.6693      74.3648       0.0000          nan          nan
```

Double CH4 (`3.4 ppm`)

```txt
Iteration    3830 at time 738.32d (63790446.2s)
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     336.9720       0.0000     240.5976     340.5000       0.0000      96.3743      32274.1     230.2405
    337.9077     334.3796      15.2287     239.4229     319.6607       3.0183      94.9567      22904.4     222.3618
    336.1121     332.5840      19.1629     239.3578     311.1599       5.7893      93.2262      18547.8     217.6421
    334.3517     330.8234      21.1263     239.4455     304.8238       8.4017      91.3779      15678.1     213.7497
    332.7973     329.2689      22.7152     239.7157     299.2309      10.8512      89.5532      13534.7     210.5657
    331.7670     328.2385      24.6066     240.4573     294.0133      13.1472      87.7812      11823.3     208.7760
    331.5716     328.0429      27.2511     241.9809     289.0169      15.3036      86.0620      10398.5     209.5656
    331.9377     328.4088      30.3454     244.0094     284.2626      17.3297      84.3993       9178.0     211.7542
    333.2780     329.7489      34.4881     246.9542     279.5554      19.2345      82.7947       8110.6     216.3197
    325.4993     321.9700      42.2988     251.6655     244.0830      39.1176      70.3045       7162.0     217.9502
    327.3199     323.7903      46.7188     254.8807     240.0779      40.5232      68.9096       6308.4     221.2260
    330.1102     326.5804      52.1676     259.0199     236.1056      41.8370      67.5605       5532.5     225.6013
    334.3253     330.7952      59.2248     264.5343     232.0409      43.0596      66.2609       4821.4     231.4260
    341.0168     337.2119      69.1751     272.1880     227.6568      44.1849      65.0239       4165.0     239.2243
    352.0752     344.9280      84.3619     281.0319     222.5219      45.1914      63.8961       3555.6     246.6606
    335.1426     322.9978     121.7052     305.8872     128.0878      85.3496      17.1105       2986.8     253.8185
    346.0166     335.3751     148.4449     330.5610     119.7666      77.8051       4.8141       2453.5     260.6644
    363.4856     348.1129     169.8980     344.1638     116.0571      77.5305       3.9491       1951.7     267.2472
    383.3009     362.1818     193.8823     359.0726     112.2959      77.1228       3.1091       1477.8     273.5891
    404.9412     377.3875     219.7632     375.0948     108.5614      76.6165       2.2927       1028.8     279.7155
    428.0856     393.4094     247.1901     391.9094     104.8620      76.0336       1.5000        602.3     285.6419
    452.6861     409.3592     276.1313     408.6255     101.1701      75.3846       0.7337        196.1     291.3620
    478.9946     408.6255     306.8024     408.6255      97.5148      74.6774       0.0000          nan          nan
```

## "Full" RRTM without water vapor feedback

Normal CO2

```txt
Iteration    1605 at time 702.15d (60665849.7s)
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6142       0.0000     246.8254     340.5000       0.0000      92.7888      33683.0     232.4627
    337.5176     336.6317      14.4499     245.2679     320.0499       3.0178      91.3638      23904.3     221.5199
    335.3476     334.4616      18.0535     244.8340     311.5056       5.7884      89.6275      19357.5     213.8645
    333.1918     332.3057      19.7310     244.5310     305.0605       8.4003      87.7747      16362.5     206.7303
    331.6411     330.7548      21.5767     244.8096     299.2150      10.8493      85.9451      14125.6     201.9021
    331.2870     330.4005      24.6820     246.2324     293.4603      13.1447      84.1681      12339.4     201.0612
    332.4844     331.5977      29.6349     249.1532     287.5495      15.3000      82.4445      10852.4     204.5937
    335.6735     334.7866      37.2588     254.0003     281.0921      17.3225      80.7864       9578.7     211.2698
    341.0275     340.1405      47.8227     260.9332     273.9854      19.2194      79.2073       8464.6     219.6940
    337.5688     336.6818      61.7826     269.7821     237.1432      38.6429      66.8997       7474.6     224.9899
    343.9374     343.0502      73.0876     277.5097     230.8884      39.9614      65.5405       6583.8     231.0529
    351.7572     350.8700      85.8407     286.6236     224.7465      41.1700      64.2464       5774.0     237.3530
    361.1549     360.2676     100.1247     297.2448     218.7514      42.2787      63.0228       5031.9     243.8913
    372.5190     371.6316     116.3057     309.7525     212.9183      43.2950      61.8792       4346.8     250.8726
    386.4554     385.5670     134.9906     324.7336     207.2409      44.2239      60.8333       3710.8     258.7190
    376.6371     372.6843     175.6082     356.0163     119.1990      81.8299      16.6681       3117.1     266.0923
    391.5013     390.7033     205.0430     385.7609     111.7098      74.7485       4.9423       2560.7     272.2837
    409.8791     409.0811     226.4961     405.0072     108.7337      74.6493       4.0739       2036.9     279.1807
    431.4728     428.2709     251.1349     425.0466     105.8407      74.4973       3.2242       1542.3     285.8143
    454.4143     447.8721     277.0724     445.4795     103.0408      74.3011       2.3926       1073.7     292.1879
    478.5967     467.3461     304.1789     465.7681     100.3490      74.0688       1.5781        628.6     298.2932
    503.9914     485.5420     332.4185     484.7614      97.7677      73.8052       0.7806        204.6     304.0813
    530.3414     484.7614     361.5192     484.7614      95.3050      73.5172       0.0000          nan          nan
```

Double CO2

```txt
Iteration    1560 at time 691.39d (59735864.2s)
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6277       0.0000     246.9056     340.5000       0.0000      92.7222      33876.9     228.1340
    338.1355     337.2632      15.3912     245.9680     319.7251       3.0192      91.2951      24041.9     220.3265
    336.0588     335.1864      19.2099     245.6279     311.0583       5.7906      89.5584      19468.9     213.6406
    333.8519     332.9793      20.8582     245.2739     304.5906       8.4031      87.7054      16456.7     206.9605
    332.3058     331.4330      22.6788     245.5574     298.7744      10.8526      85.8757      14206.9     202.5326
    332.0428     331.1698      25.8703     247.0710     293.0242      13.1483      84.0988      12410.4     201.9418
    333.3880     332.5149      31.0178     250.1394     287.0664      15.3039      82.3755      10914.9     205.4903
    336.8130     335.9398      38.9048     255.2221     280.5817      17.3266      80.7176       9633.8     212.0999
    342.5189     341.6455      49.8119     262.5068     273.4835      19.2236      79.1387       8513.4     220.4860
    339.5402     338.6667      64.2080     271.8208     236.7097      38.6225      66.8459       7517.6     225.9160
    346.3820     345.5084      75.9740     280.0217     230.4668      39.9413      65.4867       6621.7     232.0754
    354.7569     353.8832      89.2693     289.6907     224.3372      41.1504      64.1925       5807.3     238.4904
    364.7835     363.9097     104.1695     300.9410     218.3543      42.2596      62.9688       5060.8     245.1543
    376.8571     375.9833     121.0465     314.1586     212.5341      43.2765      61.8248       4371.8     252.2634
    391.5935     390.6194     140.5164     329.8411     206.8710      44.2061      60.7783       3732.1     260.1477
    382.9226     378.6697     182.1662     362.0080     118.9882      81.7681      16.6618       3135.1     267.5472
    398.5400     397.7679     212.3306     392.8242     111.5106      74.6989       4.9437       2575.4     273.8619
    417.6984     416.9262     234.5600     412.8513     108.5382      74.6002       4.0750       2048.6     280.7824
    439.9736     436.9759     259.8779     433.7507     105.6474      74.4483       3.2252       1551.2     287.4622
    463.6582     457.4321     286.5551     455.0386     102.8510      74.2520       2.3935       1079.9     293.8764
    488.6502     477.7672     314.4633     476.1884     100.1663      74.0206       1.5787        632.2     300.0164
    514.8946     496.7953     343.5422     496.0143      97.5941      73.7583       0.7809        205.8     305.8315
    542.1281     496.0143     373.5143     496.0143      95.1418      73.4720       0.0000          nan          nan
```

## "Full" RRTM with water vapor feedback but without convection

Normal CO2

```txt
Iteration    1945 at time 968.91d (83713606.2s)
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     340.5016       0.0000     243.4941     340.5000       0.0000      97.0075      32659.6     230.1928
    337.9180     337.9195      15.1505     242.3295     319.7490       3.0184      95.5900      23178.0     222.2377
    336.1196     336.1212      19.0296     242.2620     311.3005       5.7896      93.8592      18769.3     217.4250
    334.3359     334.3374      20.9372     242.3271     304.9965       8.4022      92.0103      15865.3     213.4100
    332.7345     332.7360      22.4418     242.5511     299.4408      10.8519      90.1849      13696.3     210.0769
    331.6219     331.6233      24.2001     243.2110     294.2735      13.1482      88.4123      11964.5     208.0934
    331.2842     331.2856      26.6305     244.5928     289.3488      15.3048      86.6928      10522.7     208.6481
    331.4517     331.4530      29.4417     246.4235     284.6789      17.3311      85.0295       9287.7     210.5660
    332.4850     332.4863      33.1665     249.0620     280.0822      19.2362      83.4243       8207.4     214.8060
    324.1656     324.1668      40.3358     253.2337     244.6669      39.1629      70.9331       7247.5     215.8819
    325.4080     325.4092      44.0299     255.8712     240.8053      40.5728      69.5380       6383.7     218.4952
    327.3381     327.3392      48.4243     259.1515     237.0206      41.8932      68.1877       5598.6     221.9563
    330.1800     330.1809      53.8210     263.2969     233.2323      43.1267      66.8839       4879.0     226.3722
    334.4650     334.4659      60.8680     268.8322     229.3240      44.2730      65.6336       4214.7     232.2227
    341.3065     341.3072      70.9245     276.8471     225.0580      45.3239      64.4600       3598.0     240.6442
    321.0262     321.0268     105.0733     303.7921     129.9777      85.9753      17.2347       3022.4     248.6333
    330.9931     330.9936     130.8148     326.1680     121.7569      78.4213       4.8256       2482.8     251.8996
    340.0970     340.0974     143.1072     336.1524     118.6669      78.3229       3.9450       1975.0     257.0540
    352.4925     352.4928     158.8121     349.4077     115.5548      78.1255       3.0851       1495.4     263.5633
    369.4754     369.4756     179.4119     367.2268     112.2696      77.7939       2.2489       1041.1     271.6257
    393.5150     393.5152     207.6006     392.0728     108.6393      77.2751       1.4424        609.5     281.7259
    429.1711     429.1711     248.2790     428.4917     104.4128      76.4793       0.6794        198.4     294.8415
    486.6841     428.4917     312.3164     428.4917      99.1208      75.2469       0.0000          nan          nan
```

Double CO2

```txt
Iteration    1955 at time 973.67d (84125083.8s)
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     340.5016       0.0000     243.7258     340.5000       0.0000      96.7759      32976.0     227.1070
    338.4528     338.4544      15.8683     243.0979     319.5650       3.0195      95.3565      23402.5     221.4290
    336.7444     336.7460      19.9875     243.1208     310.9658       5.7912      93.6252      18951.1     217.1950
    334.9080     334.9095      21.9038     243.1333     304.6000       8.4042      91.7762      16019.0     213.2535
    333.2760     333.2775      23.3993     243.3266     299.0225      10.8542      89.9508      13829.0     209.9832
    332.2012     332.2026      25.2021     244.0243     293.8484      13.1507      88.1783      12080.4     208.1607
    331.9744     331.9758      27.7706     245.5168     288.8962      15.3075      86.4590      10624.6     208.8721
    332.2907     332.2921      30.7882     247.4958     284.1688      17.3338      84.7963       9377.6     210.9248
    333.5294     333.5307      34.7930     250.3386     279.4976      19.2388      83.1922       8286.9     215.1658
    325.4770     325.4782      42.2655     254.7613     244.0822      39.1292      70.7169       7317.7     216.4693
    326.9505     326.9516      46.2619     257.6287     240.1516      40.5370      69.3229       6445.6     219.2268
    329.1792     329.1803      51.0263     261.2062     236.2980      41.8548      67.9741       5652.8     222.8358
    332.4193     332.4203      56.8895     265.7478     232.4444      43.0854      66.6725       4926.2     227.4274
    337.2527     337.2535      64.5645     271.8281     228.4601      44.2280      65.4254       4255.6     233.4650
    344.8760     344.8768      75.5098     280.6188     224.0928      45.2735      64.2580       3632.9     241.9906
    326.0317     326.0324     110.9297     308.8570     129.3359      85.7661      17.1755       3051.7     250.1474
    337.3852     337.3858     138.1046     332.5872     121.0653      78.2153       4.7986       2506.9     253.7753
    347.7703     347.7708     151.7993     343.8506     117.8827      78.0884       3.9202       1994.2     259.2605
    361.8633     361.8637     169.3479     358.8005     114.6611      77.8543       3.0632       1509.9     266.1255
    381.0788     381.0791     192.3623     378.8481     111.2412      77.4753       2.2309       1051.2     274.5246
    407.7322     407.7324     223.3766     406.3026     107.4582      76.8974       1.4298        615.4     284.7887
    446.0087     446.0088     266.8983     445.3351     103.0718      76.0385       0.6737        200.3     297.6980
    505.9625     445.3351     333.4890     445.3351      97.7083      74.7652       0.0000          nan          nan
```
