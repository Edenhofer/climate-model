# Simple, yet accurate one-dimensional climate model

Using the rapid radiative transfer model, this program simulates a one-dimensional atmosphere. The model incorporates several effects and achieves accurate predictions for the temperature increase for, e.g., a doubling in CO2.

## Brief repository overview

* `model.c`: Actual model to simulate the climate of the earth

* `radiative_transfer.c`: Main library for computing the transport of radiation

* `opacity_analysis.c`: Table producing program for visualizing an atmosphere with a window

* `ascii/`: Code for reading in atmospheric tables and an atmospheric table containing H2O and O3 concentrations by atmospheric layer

* `eddington/`: Code for computing transmissivity, reflectivity and scattering properties

* `gnuplot_i/`: Plotting utilities

* `rrtm/`: Folder in which it is assumed the RRTM libraries are placed in

## Simple thermal-only RRTM without water vapor feedback, cloud-fraction and so forth

Normal CO2 concentration (`400 ppm`)

```txt
Iteration   10100 at time 553.07d (47785091.6s)
      Edn[W]       Eup[W]     T_lyr[K]
      0.0000     219.1965     164.8405
      2.7151     221.9087     175.1103
         ...          ...          ...
    238.2081     369.9955     282.2349
    258.4409     381.6937     286.4367
    278.9967     381.6937          nan
```

Double CO2 concentration (`800 ppm`)

```txt
Iteration    9900 at time 541.05d (46746732.3s)
      Edn[W]       Eup[W]     T_lyr[K]
      0.0000     219.0119     163.2206
      2.8596     221.8686     174.3734
         ...          ...          ...
    245.4556     376.9652     283.5987
    266.0286     389.1324     287.8224
    286.9331     389.1324          nan
```

## "Full" RRTM with US standard atmosphere H2O and O3 concentrations

### RRTM (US) without water vapor feedback and without albedo feedback

Normal CO2

```txt
Iteration    1618 at time 717.88d (62025227.5s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6454       0.0000     245.9914     340.5000       0.0000      93.6540      33187.3     232.6904
    337.5880     336.7334      14.5187     244.4865     320.0487       3.0206      92.2469      23552.5     221.8286
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    474.0055     462.2867     279.5175     438.9407     115.6155      78.8725      23.3460        619.3     293.8845
    497.9623     479.4661     306.6224     456.8545     112.6464      78.6934      22.6116        201.6     299.6054
    522.8366     478.7721     334.5444     456.8545     109.8094      78.4827      21.9176          nan          nan
```

Normal CO2 (100 layers)

```txt
Iteration   12626 at time 744.76d (64347537.8s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5001     338.8166       0.0000     245.0954     340.5001       0.0000      93.7212      46732.6     252.3738
    338.3018     336.6183       6.6304     243.1813     330.9604       0.7110      93.4370      37042.6     234.8066
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    514.5511     486.5552     324.9494     464.3404     111.0102      78.5915      22.2148        133.3     300.1022
    520.1603     489.4865     331.2258     467.4225     110.3914      78.5431      22.0640         44.2     301.3238
    525.7851     489.3379     337.5126     467.4225     109.7791      78.4934      21.9153          nan          nan
```

Normal CO2 (1000 layers)

```txt
Iteration  140751 at time 750.28d (64824150.7s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5001     338.6080       0.0000     244.7942     340.5001       0.0000      93.8138      67085.9     295.0178
    339.4459     337.5538       2.5668     243.7712     336.8010       0.0781      93.7826      57389.5     270.6033
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    523.9543     490.4363     335.5276     468.4889     109.8981      78.5286      21.9474         13.2     301.4030
    524.5140     490.5775     336.1533     468.6449     109.8371      78.5235      21.9326          4.4     301.5207
    525.0720     490.5628     336.7774     468.6449     109.7762      78.5185      21.9179          nan          nan
```

Double CO2

```txt
Iteration    1573 at time 711.99d (61515965.7s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6841       0.0000     246.1031     340.5000       0.0000      93.5810      33372.8     228.3491
    338.2086     337.3925      15.4626     245.2207     319.7238       3.0221      92.1718      23684.1     220.6113
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    483.0439     471.7922     288.8219     448.4725     115.4088      78.8132      23.3197        622.8     295.5344
    507.7573     489.7359     316.6722     467.1515     112.4496      78.6356      22.5845        202.7     301.2801
    533.4112     489.0409     345.3611     467.1515     109.6234      78.4267      21.8894          nan          nan
```

Double CO2 (100 layers)

```txt
Iteration   12558 at time 742.07d (64115226.3s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     338.8123       0.0000     245.1626     340.5000       0.0000      93.6498      47009.7     243.9491
    338.5354     336.8476       6.9668     243.4836     330.8569       0.7117      93.3640      37262.2     229.4104
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    525.3596     497.5270     336.0078     475.3402     110.8172      78.5346      22.1868        134.1     301.8816
    531.1579     500.6377     342.4705     478.6019     110.2008      78.4866      22.0358         44.5     303.1102
    536.9719     500.4888     348.9435     478.6019     109.5910      78.4374      21.8869          nan          nan
```

Double CO2 (1000 layers)

```txt
Iteration  140647 at time 748.69d (64686855.3s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     338.5914       0.0000     244.8500     340.5000       0.0000      93.7414      67487.8     283.5794
    339.4921     337.5834       2.6274     243.8735     336.7865       0.0782      93.7099      57733.3     261.1344
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    535.1812     501.7231     347.0012     479.8043     109.7082      78.4717      21.9188         13.3     303.2089
    535.7597     501.8772     347.6456     479.9732     109.6475      78.4667      21.9040          4.4     303.3272
    536.3363     501.8624     348.2879     479.9732     109.5868      78.4616      21.8892          nan          nan
```

Double Clouds (`LWP[5./22.] = 0.5e-3; LWP[14./22.] = 14e-3; cloud-frac = 0.5;`)

```txt
Iteration    1468 at time 723.79d (62535769.0s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.8017       0.0000     234.6261     340.5000       0.0000     105.1756      33003.3     232.2599
    337.4769     336.7785      14.3888     232.8837     320.0509       3.0372     103.8948      23421.9     221.0613
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    460.9654     451.1730     279.4715     429.4155     101.9560      79.5379      21.7576        615.9     292.2929
    484.2644     467.9071     305.6522     446.8148      99.3317      79.2805      21.0923        200.5     297.9451
    508.3924     467.2802     332.5765     446.8148      96.8220      78.9940      20.4654          nan          nan
```

Double CH4

```txt
Iteration    1599 at time 712.77d (61583115.4s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5001     339.6561       0.0000     246.1083     340.5001       0.0000      93.5478      33202.0     232.7979
    337.5954     336.7514      14.6115     244.6100     319.9635       3.0205      92.1414      23562.9     222.0464
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    474.5869     462.9802     280.4175     439.6685     115.3642      78.8052      23.3117        619.6     294.0176
    498.6379     480.2441     307.6086     457.6672     112.4013      78.6280      22.5770        201.7     299.7386
    523.6004     479.5496     335.6107     457.6672     109.5703      78.4194      21.8824          nan          nan
```

Fourfold CO2

```txt
Iteration    1704 at time 702.42d (60688882.9s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6206       0.0000     246.2798     340.5000       0.0000      93.3408      33994.5     225.0439
    338.8138     337.9344      16.1458     245.9320     319.7703       2.8978      92.0024      24239.9     219.7650
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    496.6254     484.4954     302.9906     461.2674     114.9490      78.6858      23.2279        598.8     297.8012
    521.3812     502.5124     330.7201     479.9876     112.1382      78.5229      22.5248        195.2     303.3296
    547.0451     501.8457     359.2643     479.9876     109.4495      78.3314      21.8581          nan          nan
```

Montreal (CFC's without Montreal Protocol, `cfc11vmr = 8e-9; cfc12vmr = 1e-9; cfc22vmr = 1e-9; ccl4vmr = 1e-9;`)

```txt
Iteration    1551 at time 672.32d (58088502.8s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6536       0.0000     246.0021     340.5000       0.0000      93.6515      33303.0     233.4537
    337.9800     337.1335      14.9149     244.8891     320.0447       3.0204      92.2445      23634.6     223.2941
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    480.2064     468.4090     285.7235     445.0632     115.6139      78.8691      23.3459        621.5     294.9156
    504.7073     485.8716     313.3717     463.2601     112.6455      78.6901      22.6114        202.3     300.6505
    530.1359     485.1775     341.8459     463.2601     109.8102      78.4798      21.9174          nan          nan
```

Montreal (CFC's without Montreal Protocol and without sinks - correct for sinks via a decay factor of `0.45` corresponding to a mean lifetime of CFC11-equivalents of roughly 13 years, `cfc11vmr = 0.5*(4.3-0.)*(2020-1960) * 1e+9/5.15e+18; cfc12vmr = cfc22vmr = ccl4vmr = 0;`)

```txt
Iteration    1520 at time 643.71d (55616447.2s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6543       0.0000     246.0036     340.5000       0.0000      93.6507      33401.5     233.6673
    338.2165     337.3707      15.1526     245.1271     320.0436       3.0203      92.2436      23704.5     223.9356
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    485.5748     473.6569     291.0956     450.3110     115.6123      78.8670      23.3459        623.3     295.7913
    510.5464     491.3734     319.2133     468.7619     112.6449      78.6882      22.6114        202.9     301.5395
    536.4508     490.6792     348.1617     468.7619     109.8109      78.4782      21.9173          nan          nan
```

Without Cow Domestication (`ch4vmr = 1.e-6;`)

```txt
Iteration    1626 at time 719.55d (62168946.5s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5001     339.6394       0.0000     245.9338     340.5001       0.0000      93.7056      33179.8     232.6423
    337.5839     336.7233      14.4735     244.4252     320.0898       3.0207      92.2981      23547.2     221.7164
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    473.7145     461.9320     279.0703     438.5694     115.7397      78.9045      23.3626        619.2     293.8170
    497.6250     479.0720     306.1339     456.4437     112.7666      78.7246      22.6283        201.6     299.5380
    522.4590     478.3784     334.0201     456.4437     109.9260      78.5128      21.9347          nan          nan
```

Population 10B (add another 2.5B people by assuming the increase in concentrations in the last 10 years was only due to new people being born: `co2vmr += 35e-6; ch4vmr += 0.23e-6; n2ovmr += 17.7e-9`)

```txt
Iteration    1606 at time 716.12d (61872601.9s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6542       0.0000     246.0245     340.5000       0.0000      93.6297      33214.1     232.1261
    337.6648     336.8190      14.6413     244.5966     320.0027       3.0208      92.2224      23571.5     221.6855
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    475.2650     463.6478     280.8563     440.3102     115.5530      78.8557      23.3376        619.8     294.1235
    499.3208     480.9360     308.0581     458.3329     112.5857      78.6770      22.6031        201.8     299.8476
    524.3031     480.2419     336.0856     458.3329     109.7508      78.4667      21.9089          nan          nan
```

### RRTM (US) with water vapor feedback and without albedo feedback

Normal CO2

```txt
Iteration    3923 at time 825.67d (71337967.5s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     337.6918       0.0000     239.8509     340.5000       0.0000      97.8409      31574.5     230.1439
    337.8987     335.0904      15.1266     238.6469     319.7508       3.0213      96.4435      22407.9     222.1531
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    416.0214     384.2888     210.2611     360.1284     123.8296      81.9307      24.1604        589.2     279.4658
    438.0275     397.8096     236.8154     374.3374     119.7991      81.4129      23.4722        191.8     285.0462
    461.0620     397.2233     264.4511     374.3374     115.7819      80.8290      22.8859          nan          nan
```

Double CO2

```txt
Iteration    3881 at time 795.52d (68733137.9s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     337.4263       0.0000     239.9998     340.5000       0.0000      97.4265      31820.4     227.0517
    338.4298     335.3561      15.8411     239.3293     319.5664       3.0223      96.0267      22582.4     221.3372
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    427.9893     394.6684     223.8019     370.7267     122.6312      81.5562      23.9417        593.8     281.6236
    450.7518     409.3914     251.1998     386.1315     118.5371      81.0150      23.2599        193.3     287.2658
    474.6728     408.8137     279.8117     386.1315     114.4554      80.4058      22.6822          nan          nan
```

Double CH4

```txt
Iteration    3868 at time 818.91d (70754158.9s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     337.7285       0.0000     240.0858     340.5000       0.0000      97.6427      31621.3     230.2472
    337.9132     335.1416      15.2320     238.8957     319.6600       3.0211      96.2459      22441.1     222.3344
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    417.7150     386.2307     212.5974     362.1447     123.3277      81.7899      24.0860        590.1     279.8806
    439.9118     399.9597     239.3396     376.5612     119.3011      81.2711      23.3985        192.1     285.4687
    463.1623     399.3736     267.1837     376.5612     115.2918      80.6869      22.8123          nan          nan
```

Fourfold CO2

```txt
Iteration    4339 at time 792.31d (68455245.4s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     336.8615       0.0000     239.9891     340.5000       0.0000      96.8725      32413.5     224.5284
    338.9724     335.3339      16.3689     239.7909     319.7058       2.8977      95.5430      23112.6     220.7169
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    441.5156     404.6578     239.1314     380.9639     121.2267      81.1575      23.6939        571.0     283.7783
    464.0883     419.8077     266.1974     396.7571     117.2657      80.6251      23.0506        186.1     289.2225
    487.8548     419.2630     294.5086     396.7571     113.3194      80.0268      22.5059          nan          nan
```

### RRTM (US) without water vapor feedback and with albedo feedback

Normal CO2

```txt
Iteration    1637 at time 713.44d (61641303.4s) with an albedo of  0.106
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6229       0.0000     247.5699     340.5000       0.0000      92.0531      33251.7     232.7418
    337.6008     336.7236      14.5343     246.0962     320.0484       3.0181      90.6273      23598.2     221.9367
          ...          ...          ...          ...          ...          ...          ...          ...          ...
    475.7918     463.8156     281.5040     442.3450     115.6131      78.6747      21.4705        620.5     294.4519
    499.9547     481.1360     308.8181     460.4135     112.6442      78.4924      20.7224        202.0     300.1874
    525.0519     480.4264     336.9649     460.4135     109.8082      78.2788      20.0129          nan          nan
```

Double CO2

```txt
Iteration    1593 at time 707.60d (61136544.8s) with an albedo of  0.106
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6611       0.0000     247.6790     340.5000       0.0000      91.9821      33437.9     228.4006
    338.2228     337.3838      15.4798     246.8294     319.7235       3.0195      90.5544      23730.4     220.7173
          ...          ...          ...          ...          ...          ...          ...          ...          ...
    484.9316     473.4142     290.9098     451.9675     115.4064      78.6155      21.4466        624.0     296.1078
    509.8631     491.5081     318.9807     470.8104     112.4478      78.4347      20.6977        203.1     301.8685
    535.7507     490.7976     347.9053     470.8104     109.6225      78.2229      19.9871          nan          nan
```

### RRTM (US) with water vapor feedback and with albedo feedback

Normal CO2

```txt
Iteration    3922 at time 807.27d (69748369.2s) with an albedo of  0.106
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     337.5919       0.0000     241.5463     340.5000       0.0000      96.0456      31671.9     230.1919
    337.9173     335.0092      15.1500     240.3802     319.7486       3.0187      94.6290      22477.0     222.2535
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    419.1243     386.5796     214.0636     364.4384     123.4530      81.6076      22.1412        591.0     280.3233
    441.4886     400.4135     241.0204     378.9734     119.3921      81.0762      21.4401        192.4     285.9249
    464.9501     399.8094     269.1276     378.9734     115.3435      80.4790      20.8359          nan          nan
```

Double CO2

```txt
Iteration    3911 at time 784.34d (67767283.4s) with an albedo of  0.106
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     337.3085       0.0000     241.6698     340.5000       0.0000      95.6387      31919.3     227.1021
    338.4501     335.2585      15.8659     241.0388     319.5644       3.0197      94.2197      22652.6     221.4373
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    431.2406     397.1464     227.7682     375.2074     122.2434      81.2290      21.9390        595.7     282.4961
    454.3832     412.1997     255.5919     390.9557     118.1171      80.6743      21.2439        193.9     288.1591
    478.7690     411.6038     284.7121     390.9557     114.0054      80.0515      20.6481          nan          nan
```

## "Full" RRTM with self-computed H2O and O3 concentrations

### RRTM without water vapor feedback and without albedo feedback

Normal CO2

```txt
Iteration    1356 at time 592.38d (51181353.8s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5001     339.6441       0.0000     246.0018     340.5001       0.0000      93.6422      33187.5     232.6559
    337.5778     336.7219      14.5083     244.4874     320.0489       3.0207      92.2346      23552.6     221.7654
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    473.9988     462.2994     279.5270     438.9555     115.6066      78.8652      23.3439        619.3     293.8872
    497.9560     479.4782     306.6323     456.8686     112.6375      78.6861      22.6096        201.6     299.6077
    522.8300     478.7844     334.5540     456.8686     109.8006      78.4754      21.9157          nan          nan
```

Double CO2

```txt
Iteration    1358 at time 603.85d (52172443.6s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6830       0.0000     246.1141     340.5000       0.0000      93.5689      33373.1     228.3145
    338.1973     337.3803      15.4511     245.2211     319.7240       3.0221      92.1592      23684.3     220.5489
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    483.0402     471.8093     288.8356     448.4918     115.3990      78.8056      23.3175        622.8     295.5378
    507.7541     489.7524     316.6864     467.1701     112.4397      78.6279      22.5823        202.7     301.2831
    533.4076     489.0574     345.3750     467.1701     109.6136      78.4190      21.8874          nan          nan
```

### RRTM with water vapor feedback and without albedo feedback

Normal CO2

```txt
Iteration    2653 at time 1230.72d (106333896.9s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5001     339.7625       0.0000     246.6448     340.5001       0.0000      93.1177      33371.0     232.8419
    337.6111     336.8736      14.5648     245.1632     320.0266       3.0197      91.7104      23682.9     221.9546
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    482.1006     471.7165     289.1617     448.5442     114.4969      78.4420      23.1724        622.7     295.5441
    506.8212     489.4921     317.0047     467.0535     111.5518      78.2648      22.4386        202.7     301.2643
    532.4516     488.7975     345.6506     467.0535     108.7436      78.0574      21.7440          nan          nan
```

Double CO2

```txt
Iteration    3529 at time 1634.98d (141262519.2s) with an albedo of  0.116
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.8141       0.0000     247.6849     340.5000       0.0000      92.1293      33926.9     229.3318
    338.2002     337.5143      15.4085     246.7983     319.7706       3.0211      90.7160      24077.3     221.1543
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    510.3680     500.7072     321.0555     477.9837     111.7962      77.5163      22.7234        633.1     300.4987
    538.1730     520.9424     352.0457     498.9440     108.8209      77.3064      21.9984        206.1     306.2823
    567.0011     520.2552     383.9186     498.9440     106.0076      77.0749      21.3112          nan          nan
```

### RRTM without water vapor feedback and with albedo feedback

Normal CO2

```txt
Iteration    1113 at time 480.42d (41508521.4s) with an albedo of  0.106
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5001     339.6308       0.0000     247.6190     340.5001       0.0000      92.0117      33255.9     232.7581
    337.5882     336.7189      14.5454     246.1312     320.0257       3.0171      90.5878      23601.2     221.9231
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    475.9039     464.0373     281.6815     442.5735     115.5748      78.6476      21.4639        620.6     294.4911
    500.0750     481.3607     309.0009     460.6448     112.6082      78.4659      20.7159        202.0     300.2251
    525.1765     480.6512     337.1494     460.6448     109.7743      78.2529      20.0065          nan          nan
```

Double CO2

```txt
Iteration    1197 at time 525.02d (45362024.8s) with an albedo of  0.106
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.6694       0.0000     247.7291     340.5000       0.0000      91.9402      33442.3     228.4168
    338.2098     337.3791      15.4904     246.8649     319.7008       3.0186      90.5143      23733.4     220.7031
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    485.0531     473.6476     291.0988     452.2078     115.3665      78.5878      21.4397        624.1     296.1484
    509.9937     491.7443     319.1760     471.0534     112.4101      78.4076      20.6910        203.2     301.9075
    535.8856     491.0339     348.1024     471.0534     109.5869      78.1964      19.9805          nan          nan
```

### RRTM with water vapor feedback and with albedo feedback

Normal CO2

```txt
Iteration    2955 at time 1331.94d (115079252.9s) with an albedo of  0.106
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5001     339.7432       0.0000     248.4651     340.5001       0.0000      91.2781      33541.0     232.9299
    337.6432     336.8864      14.6023     247.0352     320.0238       3.0172      89.8512      23803.5     222.1066
         ...          ...          ...          ...          ...          ...          ...          ...          ...
    489.2907     478.6679     297.5321     457.4723     113.7614      77.9972      21.1956        625.9     297.0493
    514.8670     497.0909     326.2639     476.6395     110.7984      77.8047      20.4513        203.8     302.7990
    541.3928     496.3840     355.8284     476.6395     107.9801      77.5843      19.7445          nan          nan
```

Double CO2

```txt
Iteration    4143 at time 1839.74d (158953515.9s) with an albedo of  0.106
      Edn[W]       Eup[W]    Edn_lw[W]    Eup_lw[W]     E_dir[W]    Edn_sw[W]    Eup_sw[W]     z_lyr[m]     T_lyr[K]
    340.5000     339.7811       0.0000     249.5748     340.5000       0.0000      90.2063      34158.9     229.4444
    338.2440     337.5251      15.4577     248.7521     319.7678       3.0185      88.7729      24242.0     221.3411
          ...          ...          ...          ...          ...          ...          ...          ...          ...
    521.5574     511.5378     333.8463     490.7976     110.7559      76.9551      20.7403        637.4     302.5553
    550.7503     532.7311     366.2535     512.7263     107.7675      76.7293      20.0048        207.5     308.3769
    581.0444     532.0313     399.6094     512.7263     104.9494      76.4856      19.3051          nan          nan
```
